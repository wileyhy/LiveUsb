#!/bin/bash -eux

## Note, in case statements, the patterns can span more than one line. You just have to put a pipe
#+  immediately before the backslash at the end of the line

: 'Define rm()'
rm ()
{
  :;: 'Input must exist'
  (( ${#@} == 0 )) && return $LINENO
    
  : 'Vars'
  local - HH delete_d time_sfx args_rm
  delete_d=~/rm.d
  time_sfx=$(date --utc +%s)

  : '"Recycle bin" must exist'
  if ! [[ -e ${delete_d} ]] || ! [[ -d ${delete_d} ]]
  then
      mkdir --mode 0700 --verbose -- "${delete_d}" || return $LINENO
  fi

  : 'For each FSO to be recycled'
  if [[ ${end_of_options:=} = '--' ]]
  then
    echo options are over
  else
    for HH
    do
      case "${HH}" in
        -f|--force|-i|--interactive|--interactive=always|-I|--interactive=once|--interactive=never|\
        --one-file-system|--no-preserve-root|--preserve-root=all|-r|-R|--recursive|-d|--dir|-v|\
        --verbose )
          args_rm+=( "${HH}" )
          ;;    
        --help )
          command rm --help
          ;;
        --version )
          command rm --version
          ;;
        * )
          case ${HH} in
            '--' )
              end_of_options=yes
              ;;
            * )
              if [[ -e ${HH} ]]
              then
                args_rm+=( "${HH}" )
              else
                printf '\n\tInvalid imput, %s\n\n' "${HH}"
              fi
              ;;
          esac
          ;;
      esac
    done
  fi

  if [[ -n ${args_rm[*]:0:8} ]]
  then
    command mv --backup --suffix="${time_sfx}" -- "${HH}" "${delete_d}" || return 3
  fi
}
declare -fx rm

touch foo bar baz quux

rm foo
rm -f bar
rm -- baz
rm -f -- quux

